function D(t,e,r){const a=`
<main class="mx-auto my-4 border-stats max-w-5xl bg-blue-950 text-white markdown">
<h1 class="text-brass" style="margin-top: calc(4 * var(--spacing))">${t}</h1>
<p>
Please try refreshing the page, or contact the developers on Discord.
</p>
    `,s=r?`<h2>Error Details</h2><pre class="my-2 p-2 border border-white rounded-2xl"><code>${r}</code></pre>`:"";return a+s+"</main>"}function h(t){const e=t.toString(),r=e.indexOf("."),a=r==-1?e.length:r,s=t<0?1:0;if(a-s<=4)return e;let i=e.substring(a);for(let l=a;l>0;l-=3)i=e.substring(l-3,l)+i,l-3>s&&(i=","+i);return t<0&&(i="-"+i),i}const m={avatar:"Player",ghost:"Ghost",revenant:"Revenant","dire-revenant":"Dire Revenant","revenant-lord":"Revenant Lord","terrapus/child":"Juvenile Terrapus","terrapus/adult":"Adult Terrapus","terrapus/racing":"Racing Terrapus","terrapus/pet":"Pet Terrapus","terrapus/fire":"Fire Terrapus","terrapus/acid":"Acid Terrapus","terrapus/skeleton":"Skeleton Terrapus","terrapus/frost":"Frost Terrapus","terrapus/queen":"Queen Terrapus","creatures/rat":"Rat","creatures/skunk":"Skunk","creatures/skunk-pet":"Pet Skunk","creatures/armadillo":"Armadillo","creatures/roach":"Roach","creatures/roach-large":"Large Roach","creatures/bunny-ice":"Bunny","creatures/bunny-ice-pet":"Pet Bunny","creatures/crow":"Crow","creatures/crow-auto":"Cyborg Crow","creatures/crow-pet":"Pet Crow","creatures/vulture":"Vulture","creatures/vulture-pet":"Pet Vulture","creatures/bluejay":"Bluejay","creatures/cardinal":"Cardinal","creatures/seagull":"Seagull","creatures/butterfly-monarch":"Monarch Butterfly","creatures/butterfly-papilio-ulysses":"Papilio Ulysees Butterfly","creatures/butterfly-swallowtail":"Swallowtail Butterfly","creatures/butterfly-green":"Green Butterfly","creatures/butterfly-moth":"Moth","creatures/butterfly-owl":"Owl Butterfly","creatures/butterfly-paper-kite":"Paper Kite Butterfly","creatures/butterfly-rumanzovia":"Rumanzovia Butterfly","creatures/scorpion":"Scorpion","creatures/scorpion-large":"Large Scorpion","creatures/bat":"Bat","creatures/bat-auto":"Cyborg Bat","creatures/sandworm":"Sand Worm","creatures/snowworm":"Arctic Worm","creatures/tentacle":"Tentacle Monster","ground/geyser-small":"Geyser","desert/sandstorm":"Sand Storm","automata/android":"Android","automata/cat":"Android Cat","automata/dog":"Android Dog","automata/butler-brass":"Brass Butler Bot","automata/butler-diamond":"Diamond Butler Bot","automata/butler-onyx":"Onyx Butler Bot","automata/tiny":"Tiny Automata","automata/small":"Small Automata","automata/medium":"Medium Automata","automata/large":"Large Automata","brains/tiny-crawler":"Baby Crawler Brain","brains/tiny-flyer":"Baby Flyer Brain","brains/small":"Juvenile Brain","brains/medium":"Adult Brain","brains/medium-dire":"Dire Adult Brain","brains/large":"Brain Lord","aquatic/clownfish":"Clownfish","aquatic/flame-hawkfish":"Flame Hawkfish","aquatic/sergeant-major":"Sergeant Major Fish","aquatic/almaco-jack":"Almaco Jack Fish","aquatic/angelfish":"Angelfish","aquatic/codfish":"Codfish","aquatic/herring":"Herring Fish","aquatic/piranha":"Piranha","aquatic/anemone-red":"Red Anemone","aquatic/anemone-magenta":"Magenta Anemone","aquatic/anemone-electric":"Electric Anemone"},L=Object.keys(m).sort((t,e)=>m[t]<m[e]?-1:1),_=[{label:"Level:",dataPath:["level"]},{label:"Skill Level:",dataPath:["skill_level"]},{label:"Items Mined:",dataPath:["items_mined"]},{label:"Items Placed:",dataPath:["items_placed"]},{label:"Items Crafted:",dataPath:["items_crafted"]},{label:"Deaths:",dataPath:["deaths"]}],B=[{label:"Areas Discovered:",dataPath:["statistics","areas_explored"]},{label:"Automata Killed:",dataPath:["computed","automata_killed"]},{label:"Brains Killed:",dataPath:["computed","brains_killed"]},{label:"Chests Looted:",dataPath:["statistics","containers_looted"]},{label:"Creatures Killed:",dataPath:["computed","creatures_killed"]},{label:"Deliverances:",dataPath:["statistics","deliverances"]},{label:"Dungeons Raided:",dataPath:["statistics","dungeons_raided"]},{label:"Infernal Parts Discovered:",dataPath:["computed","expiator_parts_discovered"]},{label:"Landmarks Upvoted:",dataPath:["statistics","landmarks_upvoted"]},{label:"Maws Plugged:",dataPath:["statistics","maws_plugged"]},{label:"Minerals Mined:",dataPath:["statistics","minerals_mined"]},{label:"Players Killed:",dataPath:["statistics","players_killed"]},{label:"Purifier Parts Discovered:",dataPath:["computed","purifier_parts_discovered"]},{label:"Supernatural Killed:",dataPath:["computed","supernatural_killed"]},{label:"Teleporters Discovered:",dataPath:["statistics","discoveries","mechanical/teleporter"]},{label:"Trees Mined:",dataPath:["statistics","trees_mined"]},{label:"Undertakings:",dataPath:["statistics","undertakings"]}];function u(t){return t?.statistics?.kills?Object.entries(t.statistics.kills):[]}function y(t){return t?.statistics?.discoveries?Object.entries(t.statistics.discoveries):[]}const o=t=>e=>e.reduce((r,a)=>a[0].startsWith(t)?r+a[1]:r,0),M=t=>e=>e.reduce((r,a)=>a[0].includes(t)?r+a[1]:r,0),C={automata_killed:[u,o("automata/")],brains_killed:[u,o("brains/")],creatures_killed:[u,o("creatures/")],supernatural_killed:[u,M("revenant")],expiator_parts_discovered:[y,o("hell/expiator")],purifier_parts_discovered:[y,o("mechanical/geck")]};function w(t,e){return`<table class="w-full box-border"><tbody>${t.map(a=>`<tr>${e(a)}</tr>`).join("")}</tbody></table>`}function E(t){if(!t.statistics?.kills)return"";let e="";for(const r of L){const a=t.statistics.kills[r];a&&(e+=`<tr><td>${m[r]}:</td><td>${typeof a=="number"?h(a):a}</td></tr>`)}return e}function A(t){return`
<main class="flex flex-col sm:flex-row mx-auto my-4 max-w-5xl markdown">
  <div class="m-4 mb-0 grow">
    <section class="border-stats body-font bg-blue-950 text-white title-font">
      <h2 class="text-brass" style="margin-top: calc(4 * var(--spacing))">Vitals</h2>
      ${w(_,t)}
    </section>
  </div>
  <div class="m-4 mb-0 grow">
    <section class="border-stats body-font bg-blue-950 text-white title-font">
      <h2 class="text-brass" style="margin-top: calc(4 * var(--spacing))">Accomplishments</h2>
      ${w(B,t)}
    </section>
    <section class="mt-4 border-stats body-font bg-blue-950 text-white title-font">
      <h2 class="text-brass" style="margin-top: calc(4 * var(--spacing))">Kills</h2>
      <table class="w-full box-border">
        <tbody id="Kills">
        </tbody>
      </table>
    </section>
  </div>
</main>
`}const R='<td><div class="pending-row-animation"></div></td>';function j(){return A(()=>R)}function q(){return A(t=>`<td class="max-w-1/2">${t.label}</td><td id="${t.label}" class="px-4"></td>`)}function k(t,e,r){for(const a of e){let s=t;for(const n of a.dataPath)s=s[n];r[a.label]=typeof s=="number"?h(s):s}}function K(t){if(!t.computed){t.computed={};for(const[r,a]of Object.entries(C)){let s=t;for(const n of a)s=n(s);t.computed[r]=s}}const e={};return k(t,_,e),k(t,B,e),e.Kills=E(t),e}function b(t,e,r){let a='<table class="box-border w-full"><tbody>';if(r)for(let s=0;s<r.length;s++)a+=e(r[s],s);else for(let s=0;s<t;s++)a+=e(null,s);return a+="</tbody></table>",a}const f=50;function S(t,e){return`

  <div class="flex flex-col md:flex-row">
    <section class="m-4 mb-0 grow border-stats body-font bg-blue-950 text-white title-font">
      <h2 class="text-brass" style="margin-top: calc(4 * var(--spacing));">Items Mined</h2>
      ${b(f,t,e?.items_mined)}
    </section>
    <section class="m-4 mb-0 grow border-stats body-font bg-blue-950 text-white title-font">
    <h2 class="text-brass" style="margin-top: calc(4 * var(--spacing));">Items Placed</h2>
      ${b(f,t,e?.items_placed)}
    </section>
    <section class="m-4 mb-0 grow border-stats body-font bg-blue-950 text-white title-font">
      <h2 class="text-brass" style="margin-top: calc(4 * var(--spacing));">Items Crafted</h2>
      ${b(f,t,e?.items_crafted)}
    </section>
  </div>
`}function T(t){return`
<main class="mx-auto my-4 max-w-5xl markdown" id="rankings">
  ${t}
</main>
`}const O='<td><div class="pending-row-animation"></div></td>';function F(){return T(S(()=>O))}function H(){return T("")}function N(t){return{rankings:S((e,r)=>`<tr><td>${r+1}&nbsp;-</td><td class="max-w-1/2 text-gold"><a href="./players/${e[0]}">${e[0]}</a></td><td>${h(e[1])}</td></tr>`,t)}}const I=window.location.pathname,v=I.match(/\/players\/([^\/]{1,64})\/?$/),U=I.match(/\/players\/?$/),V=location.host.match(/localhost(:|$)/)?"http://localhost:3030":"https://pulse.boraini.com:3030",x=t=>V+"/?href="+encodeURIComponent(t),P="http://v2202410239072292297.goodsrv.de:5001";if(v){const[t,e]=v;d({id:"/players/$username",username:e})}else U&&d({id:"/players"});function p(t){if(t){document.getElementsByTagName("header")[0].classList.remove("hidden"),document.getElementById("title").innerHTML=t.title;const e=document.getElementById("backlink");e.setAttribute("href",t.backlink??"#"),t.backlink?e.classList.remove("hidden"):e.classList.add("hidden")}else document.getElementsByTagName("header")[0].classList.add("hidden")}function d(t){return t.id=="error"&&(c(D(t.message,null,t.stackTrace)),p(null)),(async()=>{switch(t.id){case"/players/$username":c(j()),p({title:t.username,backlink:"../players"}),await fetch(x(`${P}/players/${t.username}`)).then(async n=>{if(n.ok){const i=await n.json();c(q()),$(K(i)),document.title=`${t.username} - Deepworld 2025 MMO`}else d({id:"error",message:"Error occurred while fetching data.",stackTrace:await n.text()})});break;case"/players":c(F()),p({title:"Players"});const e=["items_mined","items_placed","items_crafted"],r=await Promise.all(e.map(n=>fetch(x(`${P}/players?sort=${n}`)))),a=r.find(n=>!n.ok);if(a){d({id:"error",message:"Error occurred while fetching data.",stackTrace:await a.text()});return}const s={};for(let n=0;n<e.length;n++){const i=e[n],l=(await r[n].json()).map(g=>[g.name,g[i]]);s[i]=l}c(H()),$(N(s));break}})().catch(e=>d({id:"error",message:"Error occurred while fetching data.",stackTrace:e}))}function c(t){document.getElementById("app").innerHTML=t}function $(t){for(const[e,r]of Object.entries(t))document.getElementById(e).innerHTML=r}
